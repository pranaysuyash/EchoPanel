# Tasks: EchoPanel v0.3 Evolution

- [x] **Full Specification & Research**
    - [x] Define Evidence-First RAG Architecture
    - [x] Integrate EmbeddingGemma and Gemma 3 research
    - [x] Finalize SOTA local model selection (Ministral, BGE-M3, GLiNER)
- [ ] **PR-1: Memory Schema & Invariants**
    - [ ] Define `segments`, `chunks`, `entities`, `events`, `frames` schemas [ ]
    - [ ] Implement timestamp validation and inheritance logic [ ]
- [ ] **PR-2: Ingestion & Offline Eval Harness**
    - [ ] Build **Offline Eval Harness Skeleton** (Corpus + Ground Truth) [ ]
    - [ ] Implement chunking + overlap strategy for ASR transcripts [ ]
    - [ ] Integrate FastEmbed (BGE-M3/Nomic) and initial EmbeddingGemma adapter [ ]
    - [ ] Implement LanceDB vector store integration [ ]
- [ ] **PR-3: Retrieval API**
    - [ ] Implement Hybrid Search (Dense + Sparse) + RRF [ ]
    - [ ] Measure Recall@K and MRR using the eval harness [ ]
- [ ] **PR-4: Synthesis API (Ollama/MLX)**
    - [ ] Implement Ministral-3 adapter with strict citation gating [ ]
    - [ ] Build "Grounded or Silent" validation logic [ ]
- [ ] **PR-5: Hybrid NER & Routing**
    - [ ] Integrate GLiNER + Regex hybrid service [ ]
    - [ ] Implement Entity-first search routing [ ]
- [ ] **PR-6: Visual Memory Path**
    - [ ] Implement native capture via **ScreenCaptureKit** [ ]
    - [ ] Implement **pHash/SSIM** Change Detection gating [ ]
    - [ ] Integrate **Apple Vision** (Tier A) for fast OCR indexing [ ]
    - [ ] Integrate **LightOnOCR-2-1B** (Tier B) for structured doc OCR [ ]
    - [ ] Integrate **SmolVLM2 (MLX)** (Tier C) for semantic summarizes [ ]
    - [ ] Implement temporal-band retrieval logic (Text + Vision fusion) [ ]
