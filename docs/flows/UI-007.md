# UI-007 Transcript Focus Navigation

## Summary

- Origin: Code-only
- Status: Hypothesized
- User navigates focus through transcript segments using up/down arrow keys.
- Boundaries crossed: UI
- Primary components (coarse list): SidePanelView, SidePanelStateLogic

## Triggers and Preconditions

- Triggers (user action, event, schedule, startup, etc.): User presses up or down arrow key while side panel is focused
- Preconditions (permissions, settings flags, availability, model cached, etc.): Side panel is open, transcript has segments

## Sequence (Happy Path)

Use numbered sequence. Each step must include evidence.
For each step:

1. <what happens>
   - Evidence:
     - Code: path :: symbol/event/string
     - Docs: path :: heading/snippet
   - Notes: (only if needed)

1. User presses up or down arrow key
   - Evidence:
     - Code: macapp/MeetingListenerApp/Sources/SidePanel/Shared/SidePanelStateLogic.swift :: handleKeyEvent (case 126: up, case 125: down)
   - Notes: Key codes 126 for up, 125 for down

1. moveFocus called with delta (+1 for down, -1 for up)
   - Evidence:
     - Code: macapp/MeetingListenerApp/Sources/SidePanel/Shared/SidePanelStateLogic.swift :: moveFocus(by: Int)
     - Code: macapp/MeetingListenerApp/Sources/SidePanelView.swift :: onMoveCommand case .up/.down
   - Notes: Called from onMoveCommand in SidePanelView

1. moveFocus updates focusedSegmentID to next/previous visible segment
   - Evidence:
     - Code: macapp/MeetingListenerApp/Sources/SidePanel/Shared/SidePanelStateLogic.swift :: moveFocus(by: Int)
   - Notes: Uses visibleTranscriptSegments array

1. UI updates focus highlight on the new segment
   - Evidence:
     - Code: macapp/MeetingListenerApp/Sources/SidePanel/Shared/SidePanelStateLogic.swift :: focusedSegmentID @Published
   - Notes: Hypothesized - SwiftUI reactive update

## Inputs and Outputs

- Inputs: Up/down arrow key press
- Outputs: Focus moves to different transcript segment, visual highlight changes
- Side effects (writes, network calls, model loads, UI state changes): UI state change for focusedSegmentID

## Failure Modes

List 5â€“10 realistic failures:

- Failure: No segments to focus
  - Where detected: moveFocus
  - Current handling (as evidenced): Guard visibleTranscriptSegments.isEmpty
  - User-visible outcome (if any): No focus change
  - Evidence: Code: macapp/MeetingListenerApp/Sources/SidePanel/Shared/SidePanelStateLogic.swift :: guard !visibleTranscriptSegments.isEmpty

- Failure: Index out of bounds
  - Where detected: moveFocus
  - Current handling (as evidenced): Clamp to 0...count-1
  - User-visible outcome (if any): Focus stays at first/last
  - Evidence: Code: macapp/MeetingListenerApp/Sources/SidePanel/Shared/SidePanelStateLogic.swift :: max(0, min(currentIndex + delta, segments.count - 1))

- Failure: Focus highlight fails to update
  - Where detected: SwiftUI rendering
  - Current handling (as evidenced): None evidenced
  - User-visible outcome (if any): Visual focus not shown
  - Evidence: Hypothesized

## Data and Storage

- What data is produced/consumed: focusedSegmentID UUID
- Where it is stored (DB/files/userData/etc.): In-memory @State/@Published in SidePanelView
- Retention / deletion controls (if documented): None, resets on view recreation

## Observability

- Logs/events emitted: None evidenced
- Correlation IDs / session IDs (if any): None
- Metrics/traces (if any): None evidenced

## Open Questions and Follow-up Tasks

- Questions that cannot be answered from current evidence: How is the focus visually indicated in the UI?
- Documentation gaps to fill: Focus highlighting implementation
- Test gaps to add (note only, no implementation): Test focus navigation with various segment counts</content>
  <parameter name="filePath">/Users/pranay/Projects/EchoPanel/docs/flows/UI-007.md
