# UI-002 Side Panel Display

## Summary

- Origin: Code-only
- Status: Implemented
- Side panel window is created/shown from menu action and stays synchronized with app state.
- Boundaries crossed: UI / OS windowing
- Primary components (coarse list): SidePanelController, SidePanelView, MeetingListenerApp

## Triggers and Preconditions

- Triggers (user action, event, schedule, startup, etc.): start-listening flow calls `sidePanelController.show(...)`
- Preconditions (permissions, settings flags, availability, model cached, etc.): app process active

## Sequence (Happy Path)

1. `toggleSession()` calls `sidePanelController.show(...)` before session start checks.
   - Evidence:
     - Code: `macapp/MeetingListenerApp/Sources/MeetingListenerApp.swift` :: `sidePanelController.show(appState:onEndSession:)`
2. Controller lazily creates an `NSPanel` with hosted `SidePanelView`.
   - Evidence:
     - Code: `macapp/MeetingListenerApp/Sources/SidePanelController.swift` :: `NSPanel(...)`, `NSHostingController(rootView:)`
3. App/window activation is forced so panel comes forward from menu bar context.
   - Evidence:
     - Code: `macapp/MeetingListenerApp/Sources/SidePanelController.swift` :: `NSRunningApplication.current.activate(...)`, `orderFrontRegardless()`
4. Mode changes resize panel via callback.
   - Evidence:
     - Code: `macapp/MeetingListenerApp/Sources/SidePanelController.swift` :: `onModeChange` -> `applyWindowLayout(...)`
5. Window close delegates back to end-session handler.
   - Evidence:
     - Code: `macapp/MeetingListenerApp/Sources/SidePanelController.swift` :: `windowWillClose` -> `onEndSession?()`

## Inputs and Outputs

- Inputs: show/hide requests, mode changes, window close
- Outputs: visible floating panel with bound app state
- Side effects (writes, network calls, model loads, UI state changes): may stop active session on window close

## Failure Modes

- Failure: Panel closed via titlebar while listening
  - Where detected: NSWindow delegate callback
  - Current handling (as evidenced): session stop callback invoked explicitly
  - User-visible outcome (if any): session ends instead of running headless
  - Evidence: `macapp/MeetingListenerApp/Sources/SidePanelController.swift` :: `windowWillClose`

- Failure: Panel fails to frontmost from menu bar app context
  - Where detected: window show path
  - Current handling (as evidenced): explicit app activation + order-front calls
  - User-visible outcome (if any): panel reliably focused
  - Evidence: `macapp/MeetingListenerApp/Sources/SidePanelController.swift` :: activation block

## Data and Storage

- What data is produced/consumed: per-mode panel frame snapshots
- Where it is stored (DB/files/userData/etc.): in-memory `savedFrameByMode`
- Retention / deletion controls (if documented): reset when controller lifetime ends

## Observability

- Logs/events emitted: close-path `NSLog` in `windowWillClose`
- Correlation IDs / session IDs (if any): not generated at window-controller layer
- Metrics/traces (if any): none

## Open Questions and Follow-up Tasks

- Questions that cannot be answered from current evidence: none
- Documentation gaps to fill: none
- Test gaps to add (note only, no implementation): window mode-resize persistence across open/close cycles
