# UI-005 Export UI Actions

## Summary

- Origin: Code-only
- Status: Implemented
- UI exposes copy/export actions and surfaces success/cancel/failure outcomes as user notices.
- Boundaries crossed: UI / Storage
- Primary components (coarse list): SidePanelTranscriptSurfaces, MeetingListenerApp, AppState

## Triggers and Preconditions

- Triggers (user action, event, schedule, startup, etc.): user clicks copy/export buttons from side panel or menu commands
- Preconditions (permissions, settings flags, availability, model cached, etc.): export buttons disabled when no transcript/action/decision/risk data

## Sequence (Happy Path)

1. Side panel footer renders `Copy Markdown`, `Export JSON`, `Export Markdown` actions.
   - Evidence:
     - Code: `macapp/MeetingListenerApp/Sources/SidePanel/Shared/SidePanelTranscriptSurfaces.swift` :: `footerControls(...)`
2. Menu bar commands expose equivalent export actions.
   - Evidence:
     - Code: `macapp/MeetingListenerApp/Sources/MeetingListenerApp.swift` :: command menu + menu content export buttons
3. Export actions call `AppState` export methods with `NSSavePanel`.
   - Evidence:
     - Code: `macapp/MeetingListenerApp/Sources/AppState.swift` :: `exportJSON()`, `exportMarkdown()`, `exportDebugBundle()`
4. Export result routes to user notice (`success`/`info`/`error`) and error logging.
   - Evidence:
     - Code: `macapp/MeetingListenerApp/Sources/AppState.swift` :: `recordExportSuccess`, `recordExportCancelled`, `recordExportFailure`
5. Side panel shows notice banner and supports dismiss.
   - Evidence:
     - Code: `macapp/MeetingListenerApp/Sources/SidePanel/Shared/SidePanelChromeViews.swift` :: `userNoticeBanner(_:)`

## Inputs and Outputs

- Inputs: export action type + destination path selection
- Outputs: JSON/Markdown/ZIP output file or explicit cancel/failure notice
- Side effects (writes, network calls, model loads, UI state changes): filesystem writes via save panel, notice state updates

## Failure Modes

- Failure: User cancels save panel
  - Where detected: save panel response guard
  - Current handling (as evidenced): explicit cancellation notice
  - User-visible outcome (if any): non-error info banner
  - Evidence: `macapp/MeetingListenerApp/Sources/AppState.swift` :: `recordExportCancelled(...)`

- Failure: File write/export exception
  - Where detected: export `do/catch`
  - Current handling (as evidenced): persistent error notice + structured error log
  - User-visible outcome (if any): visible failure message
  - Evidence: `macapp/MeetingListenerApp/Sources/AppState.swift` :: `recordExportFailure(...)`

- Failure: No exportable data
  - Where detected: `exportDisabled` state
  - Current handling (as evidenced): export controls disabled
  - User-visible outcome (if any): cannot trigger empty export from panel/menu disabled paths
  - Evidence: `macapp/MeetingListenerApp/Sources/SidePanel/Shared/SidePanelStateLogic.swift` :: `exportDisabled`

## Data and Storage

- What data is produced/consumed: live/final summary markdown, session payload JSON, optional debug bundle
- Where it is stored (DB/files/userData/etc.): user-selected file destination
- Retention / deletion controls (if documented): user-controlled filesystem retention

## Observability

- Logs/events emitted: structured export-failure logs; debug-bundle export info logs
- Correlation IDs / session IDs (if any): session id included where available (debug bundle path)
- Metrics/traces (if any): none

## Open Questions and Follow-up Tasks

- Questions that cannot be answered from current evidence: none
- Documentation gaps to fill: none
- Test gaps to add (note only, no implementation): export cancel/failure UI notice assertions in Swift tests
